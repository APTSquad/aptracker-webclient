<div class="aptracker-primary-header-report mat-elevation-z3">
  <div class="aptracker-primary-header-label"
      style="display: flex; justify-content: space-between; align-items: center; height: 100%;">
    <h1>Ежедневный отчет</h1>
    <button mat-raised-button color="accent">Завершить заполнение</button>
  </div>
</div>
<mat-progress-bar mode="determinate" value="{{percent}}"></mat-progress-bar>

<main>
    <div class="custom-calendar">
        <app-custom-calendar></app-custom-calendar>
    </div>
  <span style="display: block;
    margin-left: auto; margin-right: auto;
    text-align: center;">
    {{percent}}%
  </span>
  <button (click)="selectClient()" mat-fab style="position: fixed; bottom: 25px; right: 25px; z-index: 9999;">
      <mat-icon>add</mat-icon>
  </button>

  <form [formGroup]="form" (submit)="onSubmit()">
    <button type="submit"></button>
    <mat-list formArrayName="commonArticles" class="main-list" style="padding: 0">
      <ng-container *ngFor="let article of commonArticles.controls; let articleIndex=index">
        <ng-container *ngIf="article.value.isChecked">
          <ng-container [formGroupName]="articleIndex">
            <div class="container" fxLayout="row" fxLayout.xs="column" fxLayoutWrap fxLayoutAlign="left">
              <span fxFlex="80%" style="word-wrap:break-word;">
                {{article.value.name}}
              </span>

              <mat-form-field fxFlex="20%" style="width: 100px;"
              class="expense-form" appearance="outline" floatLabel="never">
                <input formControlName="time" type="text" matInput #expenseTime maxlength="3"
                       (focusout)="finish($event)" (input)="input()"
                       [patterns]="customPatterns" mask="0.9"
                       placeholder="0.0"/>
              </mat-form-field>
            </div>
            <!--
            <span *ngIf="article.controls.time.errors?.required">
              Name is required.
            </span>-->
          </ng-container>
        </ng-container>
      </ng-container>
    </mat-list>
    <mat-list formArrayName="clients" class="main-list" style="padding:0">
      <ng-container *ngFor="let client of clients.controls; let cIndex=index">
        <ng-container *ngIf="client.value.isChecked">
          <mat-list-item>
            {{client.value.name}}, {{cIndex}}
          </mat-list-item>
          <ng-container [formGroupName]="cIndex">
            <mat-list formArrayName="projects" class="nested-list">
              <ng-container
              *ngFor="let project of getProjectsFor(cIndex);
              let pIndex=index">
                <ng-container *ngIf="project.value.isChecked">
                  <mat-list-item>
                    {{project.value.name}}
                  </mat-list-item>
                  <ng-container [formGroupName]="pIndex">
                    <mat-list formArrayName="articles" class="nested-list">
                      <ng-container
                      *ngFor="let article of getArticlesFor(cIndex, pIndex);
                      let aIndex=index">
                        <ng-container *ngIf="article.value.isChecked">
                          <ng-container [formGroupName]="aIndex">
                            <div class="container" fxLayout="row" fxLayout.xs="column" fxLayoutWrap fxLayoutAlign="left">
                              <span fxFlex="80%" style="word-wrap:break-word;">
                                {{article.value.name}}
                              </span>

                              <mat-form-field fxFlex="20%" style="width: 100px;" class="expense-form" appearance="outline"
                                        floatLabel="never">
                                <input name="article" formControlName="time" type="text" matInput #expenseTime maxlength="3"


                                  placeholder="0.0"/>

                                  <!-- (focusout)="finish($event)" (input)="input()" [patterns]="customPatterns"  mask="0.9" -->
                              </mat-form-field>
                            </div>
                          </ng-container>
                        </ng-container>
                      </ng-container>
                    </mat-list>
                  </ng-container>
                </ng-container>
              </ng-container>
            </mat-list>
          </ng-container>
        </ng-container>
      </ng-container>
    </mat-list>
  </form>

</main>

<!--<form [formGroup]="reportForm">
  <mat-list formArrayName="clients" class="main-list" style="padding: 0">
    <ng-container *ngFor="let client of clients.controls;let clientIndex=index;">
      <mat-list-item>{{client.value.name}}</mat-list-item>
      <ng-container [formGroupName]="clientIndex">
        <mat-list formArrayName="projects" class="nested-list">
          <ng-container *ngFor="let project of getProjectsFor(clientIndex); let projectIndex=index">
            <mat-list-item>{{project.controls.name.value}}</mat-list-item>
            <ng-container [formGroupName]="projectIndex">
-->
<!--              <mat-list formArrayName="expenses" class="nested-list">-->
<!--                <ng-container *ngFor="let expense of getExpensesFor(clientIndex, projectIndex); let expenseIndex=index">-->
<!--                  <ng-container [formGroupName]="expenseIndex">-->
<!--                    <div class="container" fxLayout="row" fxLayout.xs="column" fxLayoutWrap fxLayoutAlign="left">-->

<!--                        <span fxFlex="80%" style="word-wrap:break-word;">-->
<!--                          {{expense.controls.name.value}}-->
<!--                        </span>-->

<!--                      <mat-form-field fxFlex="20%" style="width: 100px;" class="expense-form" appearance="outline"-->
<!--                                      floatLabel="never">-->
<!--                        &lt;!&ndash;  -->
<!--                          name="time" -->
<!--                        class="form-control"   &ndash;&gt;-->
<!--                        <input formControlName="time" type="text" matInput #expenseTime maxlength="3"-->
<!--                               (focusout)="finish($event)" (input)="input()"-->
<!--                               [patterns]="customPatterns" mask="0.9"-->
<!--                               placeholder="0.0"-->
<!--                        />-->
<!--                      </mat-form-field>-->
<!--                    </div>-->
<!--                  </ng-container>-->

<!--                </ng-container>-->
<!--              </mat-list>-->
<!--            </ng-container>-->
<!--          </ng-container>-->
<!--        </mat-list>-->
<!--      </ng-container>-->
<!--    </ng-container>-->
<!--  </mat-list>-->
<!--</form>-->

<!-- <mat-list class="main-list" style="padding: 0">
  <ng-container *ngFor="let item of items">
    <ng-container *ngIf="item.selected === true">
      <mat-list-item> {{item.name}} </mat-list-item>
      <mat-list class="nested-list">
        <ng-container *ngFor="let project of item.projects">
          <mat-list-item> {{project.name}} </mat-list-item>
          <mat-list class="nested-list">
            <ng-container *ngFor="let expense of project.expenses">
              <div class="container" fxLayout="row" fxLayout.xs="column" fxLayoutWrap fxLayoutAlign="left">

                <span fxFlex="80%" style="word-wrap:break-word;">
                    {{expense.name}}
                </span>

                <mat-form-field fxFlex="20%" style="width: 100px;" class="expense-form" appearance="outline"
                  floatLabel="never">
                  <input type="text" [patterns]="customPatterns" mask="0.9"
                    maxlength="3" matInput #expenseTime name="time" ngModel
                    class="form-control" placeholder="0.0" (input)="input()" (focusout)="finish($event)"/>
                </mat-form-field>
              </div>
            </ng-container>
          </mat-list>
        </ng-container>
      </mat-list>
    </ng-container>
  </ng-container>
</mat-list> -->
